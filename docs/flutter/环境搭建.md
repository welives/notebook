## 需要准备的软件和工具

- [Git](https://git-scm.com/)
- [VSCode](https://code.visualstudio.com/Download)
- [JavaJDK](https://www.oracle.com/java/technologies/downloads/)，根据自己的需要选择相应的 JDK 版本
- [AndroidStudio](https://developer.android.com/studio)
- [VS_BuildTools](https://visualstudio.microsoft.com/downloads/)
- [Scrcpy](https://scrcpy.org/download/)，一款安卓投屏软件
- [Flutter](https://docs.flutter.dev/release/archive)
- [Dart](https://gekorm.com/dart-windows/)

在 Windows 系统中，我的开发环境相关软件习惯安装到`D:\Develop`目录下(可以根据自己的喜好进行调整)，具体的安装过程省略，主要讲环境变量配置

> Flutter 的版本管理可以自己去官方网站下载指定版本，也可以使用 FVM 管理器

我平时是使用 FVM 来管理多个 Flutter 版本的：

1. 首先下载并安装上面提到的 Dart，然后新建一个系统变量或用户变量`DART_SDK`，变量值填入`D:\Develop\Dart\dart-sdk`，设置环境变量`%DART_SDK%\bin`和`%LOCALAPPDATA%\Pub\Cache\bin`
2. 打开命令行终端，输入`dart pub global activate fvm`进行 fvm 的安装
3. 新建一个系统变量或用户变量`FVM_HOME`，变量值填入`D:\Develop\fvm`，主要用来缓存 FlutterSDK 的各版本
4. 在`D:\Develop\fvm`目录下新建一个文件夹`versions`
5. 在命令行终端输入`fvm install stable`安装最新稳定版的 Flutter，更多 fvm 命令可以查看[官方文档](https://fvm.app/docs/guides/basic_commands)
6. 给 Flutter 设置全局环境变量`D:\Develop\fvm\versions\stable\bin`
7. 新建一个系统变量或用户变量`FLUTTER_STORAGE_BASE_URL`，变量值填入`https://storage.flutter-io.cn`
8. 新建一个系统变量或用户变量`PUB_HOSTED_URL`，变量值填入`https://pub.flutter-io.cn`

> 注意：fvm 是一个 bat 脚本，所以无法在`git bash`中执行，只能在`CMD`或者`PowerShell`中执行

> 在运行`flutter doctor`进行环境检查时，如果提示 `HTTP Host Availability`，则按以下处理：

- 打开`flutter\packages\flutter_tools\lib\src\http_host_validator.dart`文件
- 修改`kPubDevHttpHost`的值为`https://pub.flutter-io.cn/`
- 修改`kgCloudHttpHost`的值为`https://storage.flutter-io.cn/`
- 修改`androidRequiredHttpHosts`的值为`https://maven.aliyun.com/repository/google/`

---

安装`Android Studio`并下载所需要的相关 SDK 后可以选择设置全局环境变量也可以给某个 Flutter 版本设置局部环境变量：

- 全局环境变量：
  1. 新建系统变量或用户变量`ANDROID_HOME`和`ANDROID_SDK_ROOT`，变量值填入`D:\Develop\Android\Sdk`
  2. 新建系统变量或用户变量`ANDROID_SDK_HOME`，变量值填入`D:\Develop\Android\AVD`，这个是设置虚拟机路径
  3. 设置环境变量`%ANDROID_HOME%`、`%ANDROID_SDK_HOME%`、`%ANDROID_HOME%\platform-tools`、`%ANDROID_HOME%\emulator`、`%ANDROID_HOME%\tools`和`%ANDROID_HOME%\tools\bin`
- Flutter 局部环境变量：
  1. 先设置环境变量`D:\Develop\Android\Sdk\platform-tools`
  2. 接着在命令行终端输入`flutter config --android-sdk D:\Develop\Android\Sdk`

> 新安装`Android Studio`时，由于`jre`目录的文件不完整，需要把整个`jre`目录删除，然后在软件根目录下执行命令`mklink /D "jre" "jbr"`创建一个软链接即可

一些常用的安卓模拟器命令：

- 查看安装有哪些安卓模拟器：`emulator -list-avds`
- 修改安卓模拟器的 dns 网关地址，实现模拟器联网：`emulator -avd 模拟器名 -dns-server 局域网网关`

---

安装`Java JDK`之后的环境变量设置：

1. 根据所安装的 JDK 版本，新建一个带有大版本号的系统变量或用户变量，例如`JAVA17_HOME`，变量值填入`D:\Develop\Java\jdk_17.0.8`
2. 新建系统变量或用户变量`JAVA_HOME`，变量值填入`%JAVA17_HOME%`。如果安装有多个 JDK 版本时，只需要修改`JAVA_HOME`变量的值即可切换全局的 JDK 版本，例如修改为`%JAVA11_HOME%`
3. 设置环境变量`%JAVA_HOME%\bin`
